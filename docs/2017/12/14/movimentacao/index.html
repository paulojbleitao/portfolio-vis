<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns#">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>Movimentação no açude velho &middot; Paulo Leitão</title>
        <meta name="description" content="aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa  
     &#34;use strict&#34; function desenhaEixo(data, scale) { var svg = d3.select(&#34;#vis1&#34;), margin = {top: 20, right: 20, bottom: 30, left: 50}, width = &#43;svg.attr(&#34;width&#34;) - margin.left - margin.right, height = &#43;svg.attr(&#34;height&#34;) - margin.top - margin.bottom, g = svg.append(&#34;g&#34;).attr(&#34;transform&#34;, &#34;translate(&#34; &#43; margin.left &#43; &#34;,&#34; &#43; margin.top &#43; &#34;)&#34;); var parseTime = d3.timeParse(&#34;%H:%M&#34;); var x = d3.scaleTime() .rangeRound([0, width]) .domain(d3.extent(data, function(d) { return parseTime(d.key); })); var y = d3.">
        <meta name="HandheldFriendly" content="True">
        <meta name="MobileOptimized" content="320">
        <meta name="generator" content="Hugo 0.31" />
        <meta name="robots" content="index,follow">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta property="og:title" content="Movimentação no açude velho">
<meta property="og:description" content="aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa  
     &#34;use strict&#34; function desenhaEixo(data, scale) { var svg = d3.select(&#34;#vis1&#34;), margin = {top: 20, right: 20, bottom: 30, left: 50}, width = &#43;svg.attr(&#34;width&#34;) - margin.left - margin.right, height = &#43;svg.attr(&#34;height&#34;) - margin.top - margin.bottom, g = svg.append(&#34;g&#34;).attr(&#34;transform&#34;, &#34;translate(&#34; &#43; margin.left &#43; &#34;,&#34; &#43; margin.top &#43; &#34;)&#34;); var parseTime = d3.timeParse(&#34;%H:%M&#34;); var x = d3.scaleTime() .rangeRound([0, width]) .domain(d3.extent(data, function(d) { return parseTime(d.key); })); var y = d3.">
<meta property="og:type" content="article">
<meta property="og:url" content="http://127.0.0.1:8887/2017/12/14/movimentacao/">
        <link rel="stylesheet" href="http://127.0.0.1:8887/dist/styles.css">
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,400,600,700,300&subset=latin,cyrillic-ext,latin-ext,cyrillic">
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
        
        
    </head>
    <body>
        

        <div id="wrapper">
            <header class="site-header">
                <div class="container">
                    <div class="site-title-wrapper">
                        
                            <h1 class="site-title">
                                <a title="Portfolio" href="http://127.0.0.1:8887/">Portfolio</a>
                            </h1>
                        
                        <a class="button-square" href="http://127.0.0.1:8887/index.xml"><i class="fa fa-rss"></i></a>
                        
                        
                        
                            <a class="button-square button-social hint--top" data-hint="Github" title="Github" href="https://github.com/paulojbleitao">
                                <i class="fa fa-github-alt"></i>
                            </a>
                        
                        
                        
                        
                        
                            <a class="button-square button-social hint--top" data-hint="Email" title="Email" href="mailto:paulo.leitao@ccc.ufcg.edu.br">
                                <i class="fa fa-envelope"></i>
                            </a>
                        
                    </div>

                    <ul class="site-nav">
                        
    <li class="site-nav-item">
        <a title="Blog" href="/">Blog</a>
    </li>

    <li class="site-nav-item">
        <a title="Projects" href="/project/">Projects</a>
    </li>

    <li class="site-nav-item">
        <a title="Contact" href="/page/contact/">Contact</a>
    </li>

    <li class="site-nav-item">
        <a title="About" href="/page/about/">About</a>
    </li>

                    </ul>
                </div>
            </header>

            <div id="container">


<div class="container">
    <article class="post-container" itemscope="" itemtype="http://schema.org/BlogPosting">
        <header class="post-header">
    <h1 class="post-title" itemprop="name headline">Movimentação no açude velho</h1>
    
    <p class="post-date">
        <span>Published <time datetime="2017-12-14" itemprop="datePublished">Thu, Dec 14, 2017</time></span>
        <span>by</span>
        <span itemscope="" itemprop="author" itemtype="https://schema.org/Person">
            <span itemprop="name">
                <a href="https://github.com/paulojbleitao" itemprop="url" rel="author">Paulo Leitão</a>
            </span>
        </span>
    </p>
</header>

        <div class="post-content clearfix" itemprop="articleBody">
    

    <p><meta charset="utf-8">
<script src="https://d3js.org/d3.v4.min.js"></script>
aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa
<div class="container">
    <svg class="myvis1" id="vis1" width="800" height="500"></svg>
</div></p>

<div class="container">
    <svg class="myvis2" id="vis2" width="800" height="500"></svg>
</div>

<div class="container">
    <svg class="myvis3" id="vis3" width="800" height="500"></svg>
</div>

<!-- vis 1 -->

<script>
"use strict"

function desenhaEixo(data, scale) {
    var svg = d3.select("#vis1"),
        margin = {top: 20, right: 20, bottom: 30, left: 50},
        width = +svg.attr("width") - margin.left - margin.right,
        height = +svg.attr("height") - margin.top - margin.bottom,
        g = svg.append("g").attr("transform", "translate(" + margin.left + "," + margin.top + ")");

    var parseTime = d3.timeParse("%H:%M");

    var x = d3.scaleTime()
        .rangeRound([0, width])
        .domain(d3.extent(data, function(d) { return parseTime(d.key); }));

    var y = d3.scaleLinear()
        .rangeRound([height, 0])
        .domain(d3.extent(scale, function(d) { return d; }));

    var keys = ["Bob's", "Estátua de Jackson", "Monumento dos Burrinhos"];
    
    var z = d3.scaleOrdinal()
        .range(["#1b9e77", "#d95f02", "#7570b3"])
        .domain(keys);

    g.append("g")
        .attr("transform", "translate(0," + height + ")")
        .call(d3.axisBottom(x))
        .select(".domain")
        .remove();

    g.append("g")
        .call(d3.axisLeft(y))
        .append("text")
        .attr("fill", "#000")
        .attr("transform", "rotate(-90)")
        .attr("y", 6)
        .attr("dy", "0.71em")
        .attr("text-anchor", "end")
        .text("Quantidade de pessoas");
        
    var legend = g.append("g")
        .attr("font-family", "sans-serif")
        .attr("font-size", 10)
        .attr("text-anchor", "end")
        .selectAll("g")
        .data(keys.slice().reverse())
        .enter().append("g")
        .attr("transform", function(d, i) { return "translate(0," + i * 20 + ")"; });
    
    legend.append("rect")
        .attr("x", width - 19)
        .attr("width", 19)
        .attr("height", 19)
        .attr("fill", z);
    
    legend.append("text")
        .attr("x", width - 24)
        .attr("y", 9.5)
        .attr("dy", "0.32em")
        .text(function(d) { return d; });
}

function desenhaGrafico(dataPlace, data, scale, color) {
    var svg = d3.select("#vis1"),
        margin = {top: 20, right: 20, bottom: 30, left: 50},
        width = +svg.attr("width") - margin.left - margin.right,
        height = +svg.attr("height") - margin.top - margin.bottom,
        g = svg.append("g").attr("transform", "translate(" + margin.left + "," + margin.top + ")");

    var parseTime = d3.timeParse("%H:%M");

    var x = d3.scaleTime()
        .rangeRound([0, width]);

    var y = d3.scaleLinear()
        .rangeRound([height, 0]);

    var line = d3.line()
        .x(function(d) { return x(parseTime(d.key)); })
        .y(function(d) { return y(d.value); });
        
    x.domain(d3.extent(data, function(d) { return parseTime(d.key); }));
    y.domain(d3.extent(scale, function(d) { return d; }));

    g.append("path")
        .datum(dataPlace)
        .attr("fill", "none")
        .attr("stroke", color)
        .attr("stroke-linejoin", "round")
        .attr("stroke-linecap", "round")
        .attr("stroke-width", 1.5)
        .attr("d", line);
};

d3.csv('https://raw.githubusercontent.com/luizaugustomm/pessoas-no-acude/master/dados/processados/dados.csv', function(dados) {
    var data = d3.nest()
        .key(d => d.horario_inicial)
        .rollup(v => d3.mean(v, d => parseInt(d.total_motorizados) + parseInt(d.total_ciclistas) + parseInt(d.total_pedestres)))
        .entries(dados);

    var dataBobs = d3.nest()
        .key(d => d.horario_inicial)
        .rollup(v => d3.mean(v, d => parseInt(d.total_motorizados) + parseInt(d.total_ciclistas) + parseInt(d.total_pedestres)))
        .entries(dados.filter(d => d.local === "bobs"));

    var dataJackson = d3.nest()
        .key(d => d.horario_inicial)
        .rollup(v => d3.mean(v, d => parseInt(d.total_motorizados) + parseInt(d.total_ciclistas) + parseInt(d.total_pedestres)))
        .entries(dados.filter(d => d.local === "jackson"));

    var dataBurrinhos = d3.nest()
        .key(d => d.horario_inicial)
        .rollup(v => d3.mean(v, d => parseInt(d.total_motorizados) + parseInt(d.total_ciclistas) + parseInt(d.total_pedestres)))
        .entries(dados.filter(d => d.local === "burrinhos"));

    var max = Math.max(d3.max(dataBobs, function(d) {return d.value}), d3.max(dataJackson, function(d) {return d.value}), d3.max(dataBurrinhos, function(d) {return d.value}));
    var min = Math.min(d3.min(dataBobs, function(d) {return d.value}), d3.min(dataJackson, function(d) {return d.value}), d3.min(dataBurrinhos, function(d) {return d.value}));
    var scale = [];
    scale.push(min);
    scale.push(max);
    
    desenhaEixo(data, scale);
    desenhaGrafico(dataBobs, data, scale, "#1b9e77");
    desenhaGrafico(dataJackson, data, scale, "#d95f02");
    desenhaGrafico(dataBurrinhos, data, scale, "#7570b3");
})

</script>

<!-- vis 2 -->

<script>
var margin = {top: 20, right: 20, bottom: 30, left: 50},
    width =  800 - margin.left - margin.right,
    height = 500 - margin.top - margin.bottom;

var parseDate = d3.timeParse("%H:%M");

var svg2 = d3.select("#vis2")
    .append("g")
    .attr("transform", "translate(" + margin.left + "," + margin.top + ")");

var x = d3.scaleTime()
    .range([0, width]);

var y = d3.scaleLinear()
    .range([height, 0]);

var xAxis = d3.axisBottom()
    .scale(x);

var yAxis = d3.axisLeft()
    .scale(y);

var line = d3.area()
    .curve(d3.curveBasis)
    .x(function(d) { return x(d.horario_inicial); })
    .y(function(d) { return y(d.total_motorizados); });

var area = d3.area()
    .curve(d3.curveBasis)
    .x(function(d) { return x(d.horario_inicial); })
    .y1(function(d) { return y(d.total_motorizados); });


d3.csv("https://raw.githubusercontent.com/luizaugustomm/pessoas-no-acude/master/dados/processados/dados.csv", function(error, data) {
  if (error) throw error;

  data.forEach(function(d) {
    d.horario_inicial = parseDate(d.horario_inicial);
    d.total_motorizados = +d.total_motorizados;
    d.total_ciclistas = +d.total_ciclistas;
    d.total_pedestres = +d.total_pedestres;
  });

  x.domain(d3.extent(data, function(d) { return d.horario_inicial; }));

  y.domain([
    d3.min(data, function(d) { return Math.min(d.total_motorizados, d.total_ciclistas + d.total_pedestres) }),
    d3.max(data, function(d) { return Math.max(d.total_motorizados, d.total_ciclistas + d.total_pedestres) })
  ]);

  svg2.datum(data);

  svg2.append("clipPath")
      .attr("id", "clip-below")
    .append("path")
      .attr("d", area.y0(height));

  svg2.append("clipPath")
      .attr("id", "clip-above")
    .append("path")
      .attr("d", area.y0(0));

  svg2.append("path")
      .attr("class", "area above")
      .attr("clip-path", "url(#clip-above)")
      .attr("d", area.y0(function(d) { return y(d.total_ciclistas + d.total_pedestres); }));

  svg2.append("path")
      .attr("class", "area below")
      .attr("clip-path", "url(#clip-below)")
      .attr("d", area);

  svg2.append("path")
      .attr("class", "line")
      .attr("d", line);

  svg2.append("g")
      .attr("class", "x axis")
      .attr("transform", "translate(0," + height + ")")
      .call(xAxis);

  svg2.append("g")
      .attr("class", "y axis")
      .call(yAxis)
    .append("text")
      .attr("transform", "rotate(-90)")
      .attr("y", 6)
      .attr("dy", ".71em")
      .style("text-anchor", "end")
      .text("Homens");
});

</script>

<!-- vis 3 -->

<script>

var svg = d3.select("#vis3"),
    margin = {top: 20, right: 20, bottom: 30, left: 40},
    width = +svg.attr("width") - margin.left - margin.right,
    height = +svg.attr("height") - margin.top - margin.bottom,
    g = svg.append("g").attr("transform", "translate(" + margin.left + "," + margin.top + ")");

var parseTime = d3.timeParse("%H:%M");

var x = d3.scaleTime()
    .rangeRound([0, width]);

var y = d3.scaleLinear()
    .rangeRound([height, 0]);

var z = d3.scaleOrdinal()
    .range(["#b3cde3", "#fbb4ae"]);

d3.csv("https://raw.githubusercontent.com/luizaugustomm/pessoas-no-acude/master/dados/processados/dados.csv", function(d, i, columns) {
  d.homens_ciclistas = +d.homens_ciclistas;
  d.homens_pedestres = +d.homens_pedestres;
  d.mulheres_ciclistas = +d.mulheres_ciclistas;
  d.mulheres_pedestres = +d.mulheres_pedestres;
  d["Total de Homens"] = d.homens_ciclistas + d.homens_pedestres;
  d["Total de Mulheres"] = d.mulheres_ciclistas + d.mulheres_pedestres;
  return d;
}, function(error, data) {
  if (error) throw error;

  var keys = ["Total de Homens", "Total de Mulheres"];


  var homens = d3.nest()
       .key(d => d.horario_inicial)
       .rollup(v => d3.sum(v, d => d["Total de Homens"]))
       .entries(data);

  var mulheres = d3.nest()
       .key(d => d.horario_inicial)
       .rollup(v => d3.sum(v, d => d["Total de Mulheres"]))
       .entries(data);

   for (var i = 0; i < homens.length; i++) {
       homens[i]["Total de Homens"] = homens[i].value;
       homens[i]["Total de Mulheres"] = mulheres[i].value;
   }

  x.domain(d3.extent(data, function(d) { return parseTime(d.horario_inicial); }));
  y.domain([0, d3.max(homens, function(d) { return d["Total de Homens"] + d["Total de Mulheres"]; })]).nice();
  z.domain(keys);

  g.append("g")
    .selectAll("g")
    .data(d3.stack().keys(keys)(homens))
    .enter().append("g")
      .attr("fill", function(d) { return z(d.key); })
    .selectAll("rect")
    .data(function(d) { return d; })
    .enter().append("rect")
      .attr("x", function(d, i) { return (width / homens.length) * i; })
      .attr("y", function(d) { return y(d[1]); })
      .attr("height", function(d) { return y(d[0]) - y(d[1]); })
      .attr("width", function(d) { return width / homens.length - 1});

  g.append("g")
      .attr("class", "axis")
      .attr("transform", "translate(0," + height + ")")
      .call(d3.axisBottom(x));

  g.append("g")
      .attr("class", "axis")
      .call(d3.axisLeft(y).ticks(null, "s"))
    .append("text")
      .attr("x", 2)
      .attr("y", y(y.ticks().pop()) + 0.5)
      .attr("dy", "0.32em")
      .attr("fill", "#000")
      .attr("font-weight", "bold")
      .attr("text-anchor", "start")
      .text("Número de não motorizados");

  var legend = g.append("g")
      .attr("font-family", "sans-serif")
      .attr("font-size", 10)
      .attr("text-anchor", "end")
    .selectAll("g")
    .data(keys.slice().reverse())
    .enter().append("g")
      .attr("transform", function(d, i) { return "translate(0," + i * 20 + ")"; });

  legend.append("rect")
      .attr("x", width - 19)
      .attr("width", 19)
      .attr("height", 19)
      .attr("fill", z);

  legend.append("text")
      .attr("x", width - 24)
      .attr("y", 9.5)
      .attr("dy", "0.32em")
      .text(function(d) { return d; });
});

</script>

</div>

        <footer class="post-footer clearfix">
    

    <div class="share">
        
            <a class="icon-twitter" href="https://twitter.com/share?text=Movimenta%c3%a7%c3%a3o%20no%20a%c3%a7ude%20velho&url=http%3a%2f%2f127.0.0.1%3a8887%2f2017%2f12%2f14%2fmovimentacao%2f"
                onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
                <i class="fa fa-twitter"></i>
                <span class="hidden">Twitter</span>
            </a>
        

        
            <a class="icon-facebook" href="https://www.facebook.com/sharer/sharer.php?u=http%3a%2f%2f127.0.0.1%3a8887%2f2017%2f12%2f14%2fmovimentacao%2f"
                onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
                <i class="fa fa-facebook"></i>
                <span class="hidden">Facebook</span>
            </a>
        

        
            <a class="icon-google-plus" href="https://plus.google.com/share?url=http%3a%2f%2f127.0.0.1%3a8887%2f2017%2f12%2f14%2fmovimentacao%2f"
              onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;">
              <i class="fa fa-google-plus"></i>
                <span class="hidden">Google+</span>
            </a>
        
        
    </div>
</footer>

        
    </article>
</div>

            </div>
        </div>

        <footer class="footer">
            <div class="container">
                <div class="site-title-wrapper">
                    <h1 class="site-title">
                        <a title="Portfolio" href="http://127.0.0.1:8887/">Portfolio</a>
                    </h1>
                    <a class="button-square button-jump-top js-jump-top" href="#">
                        <i class="fa fa-angle-up"></i>
                    </a>
                </div>

                <p class="footer-copyright">
                    <span>&copy; 2017 / Powered by <a href="https://gohugo.io/">Hugo</a></span>
                </p>
                <p class="footer-copyright">
                    <span><a href="https://github.com/roryg/ghostwriter">Ghostwriter theme</a> By <a href="http://jollygoodthemes.com">JollyGoodThemes</a></span>
                    <span>/ <a href="https://github.com/jbub/ghostwriter">Ported</a> to Hugo By <a href="https://github.com/jbub">jbub</a></span>
                </p>
            </div>
        </footer>

        <script src="http://127.0.0.1:8887/js/jquery-1.11.3.min.js"></script>
        <script src="http://127.0.0.1:8887/js/jquery.fitvids.js"></script>
        
        
            <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
        
        
        <script src="http://127.0.0.1:8887/js/scripts.js"></script>
    </body>
</html>

